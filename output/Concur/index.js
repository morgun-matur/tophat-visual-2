// Generated by purs version 0.14.2
"use strict";
var Concur_Core_FRP = require("../Concur.Core.FRP/index.js");
var Concur_Core_Patterns = require("../Concur.Core.Patterns/index.js");
var Concur_Core_Types = require("../Concur.Core.Types/index.js");
var Control_Bind = require("../Control.Bind/index.js");
var Control_MultiAlternative = require("../Control.MultiAlternative/index.js");
var Data_Array = require("../Data.Array/index.js");
var Data_Functor = require("../Data.Functor/index.js");
var Data_Maybe = require("../Data.Maybe/index.js");
var Data_Tuple = require("../Data.Tuple/index.js");
var Preload = require("../Preload/index.js");
var Shift = function (ShiftMap0) {
    this.ShiftMap0 = ShiftMap0;
};
var Merge = function (MultiAlternative0) {
    this.MultiAlternative0 = MultiAlternative0;
};
var Lift = function (Alternative3, LiftWidget0, Monad2, Shift1) {
    this.Alternative3 = Alternative3;
    this.LiftWidget0 = LiftWidget0;
    this.Monad2 = Monad2;
    this.Shift1 = Shift1;
};
var wither = function (dictMonoid) {
    return function (render) {
        return function (elements) {
            var indexedElements = Data_Array.mapWithIndex(function (index) {
                return function (element) {
                    return Data_Functor.map(Concur_Core_Types.widgetFunctor)(function (v) {
                        return new Data_Tuple.Tuple(index, v);
                    })(render(element));
                };
            })(elements);
            return Control_Bind.bind(Concur_Core_Types.widgetBind)(Control_MultiAlternative.orr(Concur_Core_Types.widgetMultiAlternative(dictMonoid))(indexedElements))(function (v) {
                return Preload.done(Concur_Core_Types.widgetApplicative)((function () {
                    if (v.value1 instanceof Data_Maybe.Nothing) {
                        return Preload.withDefault(Data_Array.deleteAt(v.value0)(elements))(elements);
                    };
                    if (v.value1 instanceof Data_Maybe.Just) {
                        return Preload.withDefault(Data_Array.updateAt(v.value0)(v.value1.value0)(elements))(elements);
                    };
                    throw new Error("Failed pattern match at Concur (line 84, column 11 - line 86, column 72): " + [ v.value1.constructor.name ]);
                })());
            });
        };
    };
};
var traverse = function (dictMonoid) {
    return function (render) {
        return function (elements) {
            var indexedElements = Data_Array.mapWithIndex(function (index) {
                return function (element) {
                    return Data_Functor.map(Concur_Core_Types.widgetFunctor)(function (v) {
                        return new Data_Tuple.Tuple(index, v);
                    })(render(element));
                };
            })(elements);
            return Control_Bind.bind(Concur_Core_Types.widgetBind)(Control_MultiAlternative.orr(Concur_Core_Types.widgetMultiAlternative(dictMonoid))(indexedElements))(function (v) {
                return Preload.done(Concur_Core_Types.widgetApplicative)(Preload.withDefault(Data_Array.updateAt(v.value0)(v.value1)(elements))(elements));
            });
        };
    };
};
var repeat = function (dictBind) {
    return function (x) {
        return function (w) {
            return Control_Bind.bind(dictBind)(w(x))(function (x$prime) {
                return repeat(dictBind)(x$prime)(w);
            });
        };
    };
};
var merge = function (dictMerge) {
    return Control_MultiAlternative.orr(dictMerge.MultiAlternative0());
};
var loop = function (dictMonad) {
    return Concur_Core_FRP.loopW(dictMonad);
};
var local = function (dictAlt) {
    return function (dictMonadEffect) {
        return function (dictMonadAff) {
            return function (dictPlus) {
                return Concur_Core_Patterns.local(dictAlt)(dictMonadAff.MonadEffect0())(dictMonadAff)(dictPlus);
            };
        };
    };
};
var focus = function (dictFunctor) {
    return Concur_Core_Patterns.mapWire(dictFunctor);
};
var fix = function (dictMonad) {
    return Concur_Core_FRP.loopS(dictMonad);
};
var dynamic = function (dictMonad) {
    return Concur_Core_FRP.dyn(dictMonad);
};
var combine = function (dictMonoid) {
    return Concur_Core_Types.andd(dictMonoid);
};
var $dollar_Shift_4 = function (dictShiftMap) {
    return new Shift(function () {
        return dictShiftMap;
    });
};
var $dollar_Merge_6 = function (dictMultiAlternative) {
    return new Merge(function () {
        return dictMultiAlternative;
    });
};
var $dollar_Lift_5 = function (dictLiftWidget) {
    return function (dictShift) {
        return function (dictMonad) {
            return function (dictAlternative) {
                return new Lift(function () {
                    return dictAlternative;
                }, function () {
                    return dictLiftWidget;
                }, function () {
                    return dictMonad;
                }, function () {
                    return dictShift;
                });
            };
        };
    };
};
module.exports = {
    Shift: Shift,
    Lift: Lift,
    Merge: Merge,
    combine: combine,
    merge: merge,
    repeat: repeat,
    dynamic: dynamic,
    loop: loop,
    fix: fix,
    local: local,
    focus: focus,
    wither: wither,
    traverse: traverse,
    "$_Shift_4": $dollar_Shift_4,
    "$_Lift_5": $dollar_Lift_5,
    "$_Merge_6": $dollar_Merge_6,
    always: Concur_Core_FRP.always,
    display: Concur_Core_FRP.display,
    foldp: Concur_Core_FRP.foldp,
    hold: Concur_Core_FRP.hold,
    poll: Concur_Core_FRP.poll,
    step: Concur_Core_FRP.step,
    update: Concur_Core_FRP.update
};
