// Generated by purs version 0.14.2
"use strict";
var Control_Apply = require("../Control.Apply/index.js");
var Control_Bind = require("../Control.Bind/index.js");
var Data_Either = require("../Data.Either/index.js");
var Data_Functor = require("../Data.Functor/index.js");
var Data_HashMap = require("../Data.HashMap/index.js");
var Data_Hashable = require("../Data.Hashable/index.js");
var Data_Traversable = require("../Data.Traversable/index.js");
var Preload = require("../Preload/index.js");
var Task_Script_Error = require("../Task.Script.Error/index.js");
var Task_Script_Type = require("../Task.Script.Type/index.js");
var Expand = function (expand) {
    this.expand = expand;
};
var expand = function (dict) {
    return dict.expand;
};
var $dollar_ExpandBasicType_3 = new Expand(function (s) {
    return function (v) {
        if (v instanceof Task_Script_Type.BName) {
            return Control_Bind.bind(Data_Either.bindEither)(Data_Either.note(new Task_Script_Error.UnknownTypeName(v.value0))(Data_HashMap.lookup(Data_Hashable.hashableString)(v.value0)(s)))(expand($dollar_ExpandBasicType_3)(s));
        };
        if (v instanceof Task_Script_Type.BList) {
            return Data_Functor.map(Data_Either.functorEither)(Task_Script_Type.BList.create)(expand($dollar_ExpandBasicType_3)(s)(v.value0));
        };
        if (v instanceof Task_Script_Type.BRecord) {
            return Data_Functor.map(Data_Either.functorEither)(Task_Script_Type.BRecord.create)(Data_Traversable.traverse(Data_HashMap.traversableHashMap)(Data_Either.applicativeEither)(expand($dollar_ExpandBasicType_3)(s))(v.value0));
        };
        if (v instanceof Task_Script_Type.BVariant) {
            return Data_Functor.map(Data_Either.functorEither)(Task_Script_Type.BVariant.create)(Data_Traversable.traverse(Data_HashMap.traversableHashMap)(Data_Either.applicativeEither)(expand($dollar_ExpandBasicType_3)(s))(v.value0));
        };
        if (v instanceof Task_Script_Type.BPrimitive) {
            return Preload.done(Data_Either.applicativeEither)(new Task_Script_Type.BPrimitive(v.value0));
        };
        throw new Error("Failed pattern match at Task.Script.Expander (line 30, column 14 - line 35, column 41): " + [ v.constructor.name ]);
    };
});
var $dollar_ExpandFullType_2 = new Expand(function (s) {
    return function (v) {
        if (v instanceof Task_Script_Type.TFunction) {
            return Control_Apply.apply(Data_Either.applyEither)(Data_Functor.map(Data_Either.functorEither)(Task_Script_Type.TFunction.create)(expand($dollar_ExpandFullType_2)(s)(v.value0)))(expand($dollar_ExpandFullType_2)(s)(v.value1));
        };
        if (v instanceof Task_Script_Type.TName) {
            return Control_Bind.bind(Data_Either.bindEither)(Data_Functor.mapFlipped(Data_Either.functorEither)(Data_Either.note(new Task_Script_Error.UnknownTypeName(v.value0))(Data_HashMap.lookup(Data_Hashable.hashableString)(v.value0)(s)))(Task_Script_Type.ofBasic))(expand($dollar_ExpandFullType_2)(s));
        };
        if (v instanceof Task_Script_Type.TList) {
            return Data_Functor.map(Data_Either.functorEither)(Task_Script_Type.TList.create)(expand($dollar_ExpandFullType_2)(s)(v.value0));
        };
        if (v instanceof Task_Script_Type.TRecord) {
            return Data_Functor.map(Data_Either.functorEither)(Task_Script_Type.TRecord.create)(Data_Traversable.traverse(Data_HashMap.traversableHashMap)(Data_Either.applicativeEither)(expand($dollar_ExpandFullType_2)(s))(v.value0));
        };
        if (v instanceof Task_Script_Type.TVariant) {
            return Data_Functor.map(Data_Either.functorEither)(Task_Script_Type.TVariant.create)(Data_Traversable.traverse(Data_HashMap.traversableHashMap)(Data_Either.applicativeEither)(expand($dollar_ExpandFullType_2)(s))(v.value0));
        };
        if (v instanceof Task_Script_Type.TReference) {
            return Data_Functor.map(Data_Either.functorEither)(Task_Script_Type.TReference.create)(expand($dollar_ExpandBasicType_3)(s)(v.value0));
        };
        if (v instanceof Task_Script_Type.TTask) {
            return Data_Functor.map(Data_Either.functorEither)(Task_Script_Type.TTask.create)(Data_Traversable.traverse(Data_HashMap.traversableHashMap)(Data_Either.applicativeEither)(expand($dollar_ExpandFullType_2)(s))(v.value0));
        };
        if (v instanceof Task_Script_Type.TPrimitive) {
            return Preload.done(Data_Either.applicativeEither)(new Task_Script_Type.TPrimitive(v.value0));
        };
        throw new Error("Failed pattern match at Task.Script.Expander (line 19, column 14 - line 27, column 41): " + [ v.constructor.name ]);
    };
});
module.exports = {
    Expand: Expand,
    expand: expand,
    "$_ExpandFullType_2": $dollar_ExpandFullType_2,
    "$_ExpandBasicType_3": $dollar_ExpandBasicType_3
};
