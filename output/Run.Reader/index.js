// Generated by purs version 0.14.2
"use strict";
var Control_Applicative = require("../Control.Applicative/index.js");
var Control_Bind = require("../Control.Bind/index.js");
var Control_Category = require("../Control.Category/index.js");
var Data_Either = require("../Data.Either/index.js");
var Data_Function = require("../Data.Function/index.js");
var Data_Functor = require("../Data.Functor/index.js");
var Data_Functor_Variant = require("../Data.Functor.Variant/index.js");
var Data_Symbol = require("../Data.Symbol/index.js");
var Run = require("../Run/index.js");
var Type_Proxy = require("../Type.Proxy/index.js");
var Reader = function (x) {
    return x;
};
var runReaderAt = function (dictIsSymbol) {
    return function (dictCons) {
        return function (sym) {
            var handle = Data_Functor_Variant.on()(dictIsSymbol)(sym)(Data_Either.Left.create)(Data_Either.Right.create);
            var loop = function ($copy_e) {
                return function ($copy_r) {
                    var $tco_var_e = $copy_e;
                    var $tco_done = false;
                    var $tco_result;
                    function $tco_loop(e, r) {
                        var v = Run.peel(r);
                        if (v instanceof Data_Either.Left) {
                            var v1 = handle(v.value0);
                            if (v1 instanceof Data_Either.Left) {
                                $tco_var_e = e;
                                $copy_r = v1.value0(e);
                                return;
                            };
                            if (v1 instanceof Data_Either.Right) {
                                $tco_done = true;
                                return Control_Bind.bind(Run.bindRun)(Run.send(v1.value0))(runReaderAt(dictIsSymbol)()(sym)(e));
                            };
                            throw new Error("Failed pattern match at Run.Reader (line 111, column 15 - line 115, column 42): " + [ v1.constructor.name ]);
                        };
                        if (v instanceof Data_Either.Right) {
                            $tco_done = true;
                            return Control_Applicative.pure(Run.applicativeRun)(v.value0);
                        };
                        throw new Error("Failed pattern match at Run.Reader (line 110, column 14 - line 117, column 13): " + [ v.constructor.name ]);
                    };
                    while (!$tco_done) {
                        $tco_result = $tco_loop($tco_var_e, $copy_r);
                    };
                    return $tco_result;
                };
            };
            return loop;
        };
    };
};
var functorReader = Data_Functor.functorFn;
var liftReaderAt = function (dictIsSymbol) {
    return function (dictCons) {
        return Run.lift()(dictIsSymbol)(functorReader);
    };
};
var asksAt = function (dictIsSymbol) {
    return function (dictCons) {
        return function (sym) {
            return function (f) {
                return liftReaderAt(dictIsSymbol)()(sym)(f);
            };
        };
    };
};
var askAt = function (dictIsSymbol) {
    return function (dictCons) {
        return function (sym) {
            return asksAt(dictIsSymbol)()(sym)(Control_Category.identity(Control_Category.categoryFn));
        };
    };
};
var localAt = function (dictIsSymbol) {
    return function (dictCons) {
        return function (sym) {
            var handle = Data_Functor_Variant.on()(dictIsSymbol)(sym)(Data_Either.Left.create)(Data_Either.Right.create);
            var runLocal = (function () {
                var loop = function ($copy_e) {
                    return function ($copy_r) {
                        var $tco_var_e = $copy_e;
                        var $tco_done = false;
                        var $tco_result;
                        function $tco_loop(e, r) {
                            var v = Run.peel(r);
                            if (v instanceof Data_Either.Left) {
                                var v1 = handle(v.value0);
                                if (v1 instanceof Data_Either.Left) {
                                    $tco_var_e = e;
                                    $copy_r = v1.value0(e);
                                    return;
                                };
                                if (v1 instanceof Data_Either.Right) {
                                    $tco_done = true;
                                    return Control_Bind.bind(Run.bindRun)(Run.send(v.value0))(runLocal(e));
                                };
                                throw new Error("Failed pattern match at Run.Reader (line 88, column 17 - line 92, column 36): " + [ v1.constructor.name ]);
                            };
                            if (v instanceof Data_Either.Right) {
                                $tco_done = true;
                                return Control_Applicative.pure(Run.applicativeRun)(v.value0);
                            };
                            throw new Error("Failed pattern match at Run.Reader (line 87, column 16 - line 94, column 15): " + [ v.constructor.name ]);
                        };
                        while (!$tco_done) {
                            $tco_result = $tco_loop($tco_var_e, $copy_r);
                        };
                        return $tco_result;
                    };
                };
                return loop;
            })();
            return function (f) {
                return function (r) {
                    return Control_Bind.bind(Run.bindRun)(Data_Functor.map(Run.functorRun)(f)(askAt(dictIsSymbol)()(sym)))(Data_Function.flip(runLocal)(r));
                };
            };
        };
    };
};
var _reader = Type_Proxy["Proxy"].value;
var ask = askAt(new Data_Symbol.IsSymbol(function () {
    return "reader";
}))()(_reader);
var asks = asksAt(new Data_Symbol.IsSymbol(function () {
    return "reader";
}))()(_reader);
var liftReader = liftReaderAt(new Data_Symbol.IsSymbol(function () {
    return "reader";
}))()(_reader);
var local = localAt(new Data_Symbol.IsSymbol(function () {
    return "reader";
}))()(_reader);
var runReader = runReaderAt(new Data_Symbol.IsSymbol(function () {
    return "reader";
}))()(_reader);
module.exports = {
    Reader: Reader,
    "_reader": _reader,
    liftReader: liftReader,
    liftReaderAt: liftReaderAt,
    ask: ask,
    asks: asks,
    askAt: askAt,
    asksAt: asksAt,
    local: local,
    localAt: localAt,
    runReader: runReader,
    runReaderAt: runReaderAt,
    functorReader: functorReader
};
