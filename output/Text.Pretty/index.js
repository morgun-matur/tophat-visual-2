// Generated by purs version 0.14.2
"use strict";
var Data_Array = require("../Data.Array/index.js");
var Data_Foldable = require("../Data.Foldable/index.js");
var Data_Functor = require("../Data.Functor/index.js");
var Data_Monoid = require("../Data.Monoid/index.js");
var Data_Newtype = require("../Data.Newtype/index.js");
var Data_Ord = require("../Data.Ord/index.js");
var Data_Semigroup = require("../Data.Semigroup/index.js");
var Data_String_CodePoints = require("../Data.String.CodePoints/index.js");
var Data_String_CodeUnits = require("../Data.String.CodeUnits/index.js");
var Data_String_Common = require("../Data.String.Common/index.js");
var Data_Unfoldable = require("../Data.Unfoldable/index.js");
var Doc = function (x) {
    return x;
};
var Stack = function (x) {
    return x;
};
var Columns = function (x) {
    return x;
};
var width = function (v) {
    return v.width;
};
var text = function (s) {
    var lines = Data_String_Common.split(Data_Newtype.wrap()("\x0a"))(s);
    return {
        width: Data_Foldable.foldl(Data_Foldable.foldableArray)(Data_Ord.max(Data_Ord.ordInt))(0)(Data_Functor.map(Data_Functor.functorArray)(Data_String_CodePoints.length)(lines)),
        height: Data_Array.length(lines),
        lines: lines
    };
};
var render = function (v) {
    return Data_Foldable.intercalate(Data_Foldable.foldableArray)(Data_Monoid.monoidString)("\x0a")(v.lines);
};
var newtypeStack = new Data_Newtype.Newtype(function () {
    return undefined;
});
var newtypeColumns = new Data_Newtype.Newtype(function () {
    return undefined;
});
var height = function (v) {
    return v.height;
};
var empty = function (w) {
    return function (h) {
        return {
            width: w,
            height: h,
            lines: (function () {
                if (h === 0) {
                    return [  ];
                };
                return Data_Functor.voidLeft(Data_Functor.functorArray)(Data_Array.range(1)(h))("");
            })()
        };
    };
};
var beside = function (v) {
    return function (v1) {
        var height_ = Data_Ord.max(Data_Ord.ordInt)(v.height)(v1.height);
        var emptyLine = function (w) {
            return Data_String_CodeUnits.fromCharArray(Data_Unfoldable.replicate(Data_Unfoldable.unfoldableArray)(w)(" "));
        };
        var padRight = function (w) {
            return function (s) {
                return s + emptyLine(w - Data_String_CodePoints.length(s) | 0);
            };
        };
        var adjust = function (d) {
            return Data_Semigroup.append(Data_Semigroup.semigroupArray)(d.lines)(Data_Unfoldable.replicate(Data_Unfoldable.unfoldableArray)(height_ - d.height | 0)(emptyLine(d.width)));
        };
        return {
            width: v.width + v1.width | 0,
            height: height_,
            lines: Data_Array.take(height_)(Data_Array.zipWith(Data_Semigroup.append(Data_Semigroup.semigroupString))(Data_Functor.map(Data_Functor.functorArray)(padRight(v.width))(adjust(v)))(adjust(v1)))
        };
    };
};
var semigroupColumns = new Data_Semigroup.Semigroup(function (v) {
    return function (v1) {
        return beside(v)(v1);
    };
});
var monoidColumns = new Data_Monoid.Monoid(function () {
    return semigroupColumns;
}, empty(0)(0));
var hcat = function (dictFoldable) {
    return Data_Newtype.ala()()()(Columns)(Data_Foldable.foldMap(dictFoldable)(monoidColumns));
};
var atop = function (v) {
    return function (v1) {
        return {
            width: Data_Ord.max(Data_Ord.ordInt)(v.width)(v1.width),
            height: v.height + v1.height | 0,
            lines: Data_Semigroup.append(Data_Semigroup.semigroupArray)(v.lines)(v1.lines)
        };
    };
};
var semigroupStack = new Data_Semigroup.Semigroup(function (v) {
    return function (v1) {
        return atop(v)(v1);
    };
});
var monoidStack = new Data_Monoid.Monoid(function () {
    return semigroupStack;
}, empty(0)(0));
var vcat = function (dictFoldable) {
    return Data_Newtype.ala()()()(Stack)(Data_Foldable.foldMap(dictFoldable)(monoidStack));
};
module.exports = {
    width: width,
    height: height,
    render: render,
    empty: empty,
    text: text,
    beside: beside,
    atop: atop,
    Stack: Stack,
    vcat: vcat,
    Columns: Columns,
    hcat: hcat,
    newtypeStack: newtypeStack,
    semigroupStack: semigroupStack,
    monoidStack: monoidStack,
    newtypeColumns: newtypeColumns,
    semigroupColumns: semigroupColumns,
    monoidColumns: monoidColumns
};
