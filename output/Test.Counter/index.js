// Generated by purs version 0.14.2
"use strict";
var Concur = require("../Concur/index.js");
var Concur_Core_FRP = require("../Concur.Core.FRP/index.js");
var Concur_Core_LiftWidget = require("../Concur.Core.LiftWidget/index.js");
var Concur_Core_Props = require("../Concur.Core.Props/index.js");
var Concur_Core_Types = require("../Concur.Core.Types/index.js");
var Concur_Dom_Icon = require("../Concur.Dom.Icon/index.js");
var Concur_React_DOM = require("../Concur.React.DOM/index.js");
var Concur_React_Props = require("../Concur.React.Props/index.js");
var Control_Bind = require("../Control.Bind/index.js");
var Control_Cofree = require("../Control.Cofree/index.js");
var Data_Array = require("../Data.Array/index.js");
var Data_Foldable = require("../Data.Foldable/index.js");
var Data_Functor = require("../Data.Functor/index.js");
var Data_HeytingAlgebra = require("../Data.HeytingAlgebra/index.js");
var Data_Maybe = require("../Data.Maybe/index.js");
var Data_Monoid = require("../Data.Monoid/index.js");
var Data_Show = require("../Data.Show/index.js");
var Data_Symbol = require("../Data.Symbol/index.js");
var Data_Traversable = require("../Data.Traversable/index.js");
var isSorted = function (xs) {
    var v = Data_Array.tail(xs);
    if (v instanceof Data_Maybe.Nothing) {
        return true;
    };
    if (v instanceof Data_Maybe.Just) {
        return Data_Foldable.and(Data_Foldable.foldableArray)(Data_HeytingAlgebra.heytingAlgebraBoolean)(Data_Array.zipWith(function (x) {
            return function (y) {
                return x <= y;
            };
        })(xs)(v.value0));
    };
    throw new Error("Failed pattern match at Test.Counter (line 68, column 15 - line 70, column 57): " + [ v.constructor.name ]);
};
var counter = function (n) {
    return Concur_React_DOM["div'"](Concur_Core_Types.widgetMultiAlternative(Data_Monoid.monoidArray))(Concur_Core_Types.widgetShiftMap)([ Concur_React_DOM.button(Concur_Core_Types.widgetMultiAlternative(Data_Monoid.monoidArray))(Concur_Core_Types.widgetShiftMap)([ Data_Functor.voidLeft(Concur_Core_Props.functorProps)(Concur_React_Props.onClick)(n + 1 | 0) ])([ Concur_Dom_Icon.plus_square ]), Concur_React_DOM.text(Concur_Core_LiftWidget.widgetLiftWidget)(Data_Show.show(Data_Show.showInt)(n)), Concur_React_DOM.button(Concur_Core_Types.widgetMultiAlternative(Data_Monoid.monoidArray))(Concur_Core_Types.widgetShiftMap)([ Data_Functor.voidLeft(Concur_Core_Props.functorProps)(Concur_React_Props.onClick)(n - 1 | 0) ])([ Concur_Dom_Icon.minus_square ]) ]);
};
var counter_ = function (k) {
    return Concur.loop(Concur_Core_Types.widgetMonad)(k)(counter);
};
var counters_ = function (xs) {
    return Control_Bind.discard(Control_Bind.discardUnit)(Control_Cofree.bindCofree(Concur_Core_Types.widgetAlternative(Data_Monoid.monoidArray)))(Concur_Core_FRP.display(Concur_React_DOM.text(Concur_Core_LiftWidget.widgetLiftWidget)(Data_Show.show(Data_Show.showRecord()(Data_Show.showRecordFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "content";
    }))(Data_Show.showRecordFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "isSorted";
    }))(Data_Show.showRecordFieldsNil)(Data_Show.showBoolean))(Data_Show.showArray(Data_Show.showInt))))({
        content: xs,
        isSorted: isSorted(xs)
    }))))(function () {
        return Data_Traversable.traverse(Data_Traversable.traversableArray)(Control_Cofree.applicativeCofree(Concur_Core_Types.widgetAlternative(Data_Monoid.monoidArray)))(counter_)(xs);
    });
};
var main_ = Concur.dynamic(Concur_Core_Types.widgetMonad)(Concur.fix(Concur_Core_Types.widgetMonad)([ 1, 2, 3 ])(counters_));
var counters = function (xs) {
    return Concur.combine(Data_Monoid.monoidArray)(Data_Functor.map(Data_Functor.functorArray)(counter)(xs));
};
var counters__ = function (xs) {
    return Control_Bind.discard(Control_Bind.discardUnit)(Control_Cofree.bindCofree(Concur_Core_Types.widgetAlternative(Data_Monoid.monoidArray)))(Concur_Core_FRP.display(Concur_React_DOM.text(Concur_Core_LiftWidget.widgetLiftWidget)(Data_Show.show(Data_Show.showRecord()(Data_Show.showRecordFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "content";
    }))(Data_Show.showRecordFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "isSorted";
    }))(Data_Show.showRecordFieldsNil)(Data_Show.showBoolean))(Data_Show.showArray(Data_Show.showInt))))({
        content: xs,
        isSorted: isSorted(xs)
    }))))(function () {
        return Concur.loop(Concur_Core_Types.widgetMonad)(xs)(counters);
    });
};
var main = counters([ 1, 2, 3 ]);
module.exports = {
    counter: counter,
    counters: counters,
    main: main,
    counter_: counter_,
    counters_: counters_,
    counters__: counters__,
    main_: main_,
    isSorted: isSorted
};
