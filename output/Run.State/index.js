// Generated by purs version 0.14.2
"use strict";
var Control_Applicative = require("../Control.Applicative/index.js");
var Control_Bind = require("../Control.Bind/index.js");
var Control_Category = require("../Control.Category/index.js");
var Data_Either = require("../Data.Either/index.js");
var Data_Function = require("../Data.Function/index.js");
var Data_Functor = require("../Data.Functor/index.js");
var Data_Functor_Variant = require("../Data.Functor.Variant/index.js");
var Data_Symbol = require("../Data.Symbol/index.js");
var Data_Tuple = require("../Data.Tuple/index.js");
var Data_Unit = require("../Data.Unit/index.js");
var Run = require("../Run/index.js");
var Type_Proxy = require("../Type.Proxy/index.js");
var State = (function () {
    function State(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    State.create = function (value0) {
        return function (value1) {
            return new State(value0, value1);
        };
    };
    return State;
})();
var runStateAt = function (dictIsSymbol) {
    return function (dictCons) {
        return function (sym) {
            var handle = Data_Functor_Variant.on()(dictIsSymbol)(sym)(Data_Either.Left.create)(Data_Either.Right.create);
            var loop = function ($copy_s) {
                return function ($copy_r) {
                    var $tco_var_s = $copy_s;
                    var $tco_done = false;
                    var $tco_result;
                    function $tco_loop(s, r) {
                        var v = Run.peel(r);
                        if (v instanceof Data_Either.Left) {
                            var v1 = handle(v.value0);
                            if (v1 instanceof Data_Either.Left) {
                                var s$prime = v1.value0.value0(s);
                                $tco_var_s = s$prime;
                                $copy_r = v1.value0.value1(s$prime);
                                return;
                            };
                            if (v1 instanceof Data_Either.Right) {
                                $tco_done = true;
                                return Control_Bind.bind(Run.bindRun)(Run.send(v1.value0))(runStateAt(dictIsSymbol)()(sym)(s));
                            };
                            throw new Error("Failed pattern match at Run.State (line 117, column 15 - line 122, column 41): " + [ v1.constructor.name ]);
                        };
                        if (v instanceof Data_Either.Right) {
                            $tco_done = true;
                            return Control_Applicative.pure(Run.applicativeRun)(new Data_Tuple.Tuple(s, v.value0));
                        };
                        throw new Error("Failed pattern match at Run.State (line 116, column 14 - line 124, column 23): " + [ v.constructor.name ]);
                    };
                    while (!$tco_done) {
                        $tco_result = $tco_loop($tco_var_s, $copy_r);
                    };
                    return $tco_result;
                };
            };
            return loop;
        };
    };
};
var functorState = new Data_Functor.Functor(function (f) {
    return function (m) {
        return new State(m.value0, Data_Functor.map(Data_Functor.functorFn)(f)(m.value1));
    };
});
var liftStateAt = function (dictIsSymbol) {
    return function (dictCons) {
        return Run.lift()(dictIsSymbol)(functorState);
    };
};
var getAt = function (dictIsSymbol) {
    return function (dictCons) {
        return function (sym) {
            return liftStateAt(dictIsSymbol)()(sym)(new State(Control_Category.identity(Control_Category.categoryFn), Control_Category.identity(Control_Category.categoryFn)));
        };
    };
};
var getsAt = function (dictIsSymbol) {
    return function (dictCons) {
        return function (sym) {
            return Data_Function.flip(Data_Functor.map(Run.functorRun))(getAt(dictIsSymbol)()(sym));
        };
    };
};
var modifyAt = function (dictIsSymbol) {
    return function (dictCons) {
        return function (sym) {
            return function (f) {
                return liftStateAt(dictIsSymbol)()(sym)(new State(f, Data_Function["const"](Data_Unit.unit)));
            };
        };
    };
};
var putAt = function (dictIsSymbol) {
    return function (dictCons) {
        return function (sym) {
            var $33 = modifyAt(dictIsSymbol)()(sym);
            return function ($34) {
                return $33(Data_Function["const"]($34));
            };
        };
    };
};
var execStateAt = function (dictIsSymbol) {
    return function (dictCons) {
        return function (sym) {
            return function (s) {
                var $35 = Data_Functor.map(Run.functorRun)(Data_Tuple.fst);
                var $36 = runStateAt(dictIsSymbol)()(sym)(s);
                return function ($37) {
                    return $35($36($37));
                };
            };
        };
    };
};
var evalStateAt = function (dictIsSymbol) {
    return function (dictCons) {
        return function (sym) {
            return function (s) {
                var $38 = Data_Functor.map(Run.functorRun)(Data_Tuple.snd);
                var $39 = runStateAt(dictIsSymbol)()(sym)(s);
                return function ($40) {
                    return $38($39($40));
                };
            };
        };
    };
};
var _state = Type_Proxy["Proxy"].value;
var evalState = evalStateAt(new Data_Symbol.IsSymbol(function () {
    return "state";
}))()(_state);
var execState = execStateAt(new Data_Symbol.IsSymbol(function () {
    return "state";
}))()(_state);
var get = getAt(new Data_Symbol.IsSymbol(function () {
    return "state";
}))()(_state);
var gets = getsAt(new Data_Symbol.IsSymbol(function () {
    return "state";
}))()(_state);
var liftState = liftStateAt(new Data_Symbol.IsSymbol(function () {
    return "state";
}))()(_state);
var modify = modifyAt(new Data_Symbol.IsSymbol(function () {
    return "state";
}))()(_state);
var put = putAt(new Data_Symbol.IsSymbol(function () {
    return "state";
}))()(_state);
var runState = runStateAt(new Data_Symbol.IsSymbol(function () {
    return "state";
}))()(_state);
module.exports = {
    State: State,
    "_state": _state,
    liftState: liftState,
    liftStateAt: liftStateAt,
    modify: modify,
    modifyAt: modifyAt,
    put: put,
    putAt: putAt,
    get: get,
    getAt: getAt,
    gets: gets,
    getsAt: getsAt,
    runState: runState,
    runStateAt: runStateAt,
    evalState: evalState,
    evalStateAt: evalStateAt,
    execState: execState,
    execStateAt: execStateAt,
    functorState: functorState
};
