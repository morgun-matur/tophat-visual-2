// Generated by purs version 0.14.2
"use strict";
var Data_Doc = require("../Data.Doc/index.js");
var Data_Either = require("../Data.Either/index.js");
var Data_Functor = require("../Data.Functor/index.js");
var Data_HashMap = require("../Data.HashMap/index.js");
var Data_Maybe = require("../Data.Maybe/index.js");
var Data_Show = require("../Data.Show/index.js");
var Data_Traversable = require("../Data.Traversable/index.js");
var Data_Unit = require("../Data.Unit/index.js");
var Task_Script_Error = require("../Task.Script.Error/index.js");
var Task_Script_Syntax = require("../Task.Script.Syntax/index.js");
var Task_Script_Type = require("../Task.Script.Type/index.js");
var Text_Pretty = require("../Text.Pretty/index.js");
var Success = (function () {
    function Success(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    Success.create = function (value0) {
        return function (value1) {
            return new Success(value0, value1);
        };
    };
    return Success;
})();
var Failure = (function () {
    function Failure(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    Failure.create = function (value0) {
        return function (value1) {
            return new Failure(value0, value1);
        };
    };
    return Failure;
})();
var Unknown = (function () {
    function Unknown() {

    };
    Unknown.value = new Unknown();
    return Unknown;
})();
var Annotated = (function () {
    function Annotated(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    Annotated.create = function (value0) {
        return function (value1) {
            return new Annotated(value0, value1);
        };
    };
    return Annotated;
})();
var withTypeOf = function (c) {
    return function (b) {
        return function (f) {
            if (c.value0 instanceof Success) {
                return f(c.value0.value1);
            };
            return new Annotated(Unknown.value, b);
        };
    };
};
var unchecked = Annotated.create(Unknown.value);
var unannotate = function (dictFunctor) {
    return function (v) {
        return new Annotated(Data_Unit.unit, Data_Functor.map(dictFunctor)(unannotate(dictFunctor))(v.value1));
    };
};
var sink = function (g) {
    return function (c) {
        return function (v) {
            if (v instanceof Data_Either.Left) {
                return new Annotated(Unknown.value, c);
            };
            if (v instanceof Data_Either.Right) {
                return new Annotated(new Success(g, v.value0), c);
            };
            throw new Error("Failed pattern match at Task.Script.Annotation (line 60, column 12 - line 62, column 39): " + [ v.constructor.name ]);
        };
    };
};
var pass = function (g) {
    return function (c) {
        return function (a) {
            return new Annotated(new Success(g, a), c);
        };
    };
};
var lift = function (g) {
    return function (u) {
        return function (c) {
            return function (v) {
                if (v instanceof Data_Either.Left) {
                    return new Annotated(new Failure(g, v.value0), u);
                };
                if (v instanceof Data_Either.Right) {
                    return new Annotated(new Success(g, v.value0), c);
                };
                throw new Error("Failed pattern match at Task.Script.Annotation (line 55, column 14 - line 57, column 39): " + [ v.constructor.name ]);
            };
        };
    };
};
var fail = function (g) {
    return function (u) {
        return function (e) {
            return new Annotated(new Failure(g, e), u);
        };
    };
};
var extractType = function (v) {
    if (v.value0 instanceof Success) {
        return new Data_Either.Right(v.value0.value1);
    };
    return new Data_Either.Left(Task_Script_Error.UndeterminedType.value);
};
var extractError = function (v) {
    if (v instanceof Failure) {
        return Data_Maybe.Just.create(Data_Show.show(Task_Script_Error["$_ShowError_1"])(v.value1));
    };
    return Data_Maybe.Nothing.value;
};
var extractContext = function (v) {
    if (v instanceof Failure) {
        return v.value0;
    };
    if (v instanceof Success) {
        return v.value0;
    };
    if (v instanceof Unknown) {
        return Data_HashMap.empty;
    };
    throw new Error("Failed pattern match at Task.Script.Annotation (line 87, column 1 - line 87, column 36): " + [ v.constructor.name ]);
};
var bury = Annotated.create(Unknown.value);
var $dollar_DisplayUnannotatedTask_10 = new Data_Doc.Display(function (v) {
    return Data_Doc.display(Task_Script_Syntax["$_DisplayTask_137"]($dollar_DisplayUnannotatedTask_10))(v.value1);
});
var $dollar_ShowUnannotatedTask_11 = new Data_Show.Show((function () {
    var $51 = Data_Doc.display($dollar_DisplayUnannotatedTask_10);
    return function ($52) {
        return Text_Pretty.render($51($52));
    };
})());
var $dollar_DisplayCheckedTask_8 = new Data_Doc.Display(function (v) {
    if (v.value0 instanceof Success) {
        return Data_Doc.words(Data_Traversable.traversableArray)([ Text_Pretty.text("("), Data_Doc.display(Task_Script_Syntax["$_DisplayTask_137"]($dollar_DisplayCheckedTask_8))(v.value1), Text_Pretty.text(":"), Data_Doc.show(Task_Script_Type["$_ShowFullType_49"])(v.value0.value1), Text_Pretty.text(")") ]);
    };
    if (v.value0 instanceof Failure) {
        return Data_Doc.words(Data_Traversable.traversableArray)([ Text_Pretty.text("(!"), Data_Doc.display(Task_Script_Syntax["$_DisplayTask_137"]($dollar_DisplayCheckedTask_8))(v.value1), Text_Pretty.text(":"), Data_Doc.show(Task_Script_Error["$_ShowError_1"])(v.value0.value1), Text_Pretty.text("!)") ]);
    };
    if (v.value0 instanceof Unknown) {
        return Data_Doc.words(Data_Traversable.traversableArray)([ Text_Pretty.text("(?"), Data_Doc.display(Task_Script_Syntax["$_DisplayTask_137"]($dollar_DisplayCheckedTask_8))(v.value1), Text_Pretty.text("?)") ]);
    };
    throw new Error("Failed pattern match at Task.Script.Annotation (line 28, column 29 - line 31, column 69): " + [ v.value0.constructor.name ]);
});
var $dollar_ShowCheckedTask_9 = new Data_Show.Show((function () {
    var $53 = Data_Doc.display($dollar_DisplayCheckedTask_8);
    return function ($54) {
        return Text_Pretty.render($53($54));
    };
})());
module.exports = {
    Annotated: Annotated,
    Success: Success,
    Failure: Failure,
    Unknown: Unknown,
    unannotate: unannotate,
    unchecked: unchecked,
    lift: lift,
    sink: sink,
    fail: fail,
    pass: pass,
    bury: bury,
    extractType: extractType,
    withTypeOf: withTypeOf,
    extractError: extractError,
    extractContext: extractContext,
    "$_DisplayCheckedTask_8": $dollar_DisplayCheckedTask_8,
    "$_ShowCheckedTask_9": $dollar_ShowCheckedTask_9,
    "$_DisplayUnannotatedTask_10": $dollar_DisplayUnannotatedTask_10,
    "$_ShowUnannotatedTask_11": $dollar_ShowUnannotatedTask_11
};
